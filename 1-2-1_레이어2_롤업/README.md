# 이더리움 확장성 솔루션: 레이어2 롤업

태그: Blockchain, Layer2, Rollup
프로젝트: 블록체인 강의

##  congested-ethereum.svg

![congested-ethereum.svg](congested-ethereum.svg)

## 📜 다이어그램 설명

이더리움은 전 세계 수많은 사용자가 이용하는 탈중앙화 애플리케이션(DApp) 플랫폼이지만, 한정된 블록 공간 때문에 모든 거래를 신속하게 처리하는 데 어려움을 겪습니다. 이는 마치 **교통 체증으로 꽉 막힌 1차선 도로**와 같습니다.

1.  **거래 폭증**: 사용자들이 DeFi, NFT, 게임 등 다양한 DApp을 이용하면서 수많은 트랜잭션(차량)이 이더리움 메인넷(도로)으로 몰려듭니다.
2.  **한정된 처리 용량**: 이더리움은 약 12초마다 하나의 블록(버스를)을 생성하며, 이 블록에 담을 수 있는 거래의 양은 제한되어 있습니다. 도로의 차선이 하나뿐이라 한 번에 지나갈 수 있는 차량의 수가 정해져 있는 것과 같습니다.
3.  **가스비 경쟁**: 블록에 포함되기 위해 사용자들은 더 높은 가스비(통행료)를 지불하며 경쟁합니다. 이는 도로를 더 빨리 지나가기 위해 웃돈을 내는 것과 같아서, 네트워크 전체의 거래 비용을 급등시킵니다.
4.  **느린 속도와 비싼 수수료**: 결국 많은 사용자들이 비싼 수수료와 느린 처리 속도로 인해 불편을 겪게 됩니다.

이러한 문제를 **'블록체인 트릴레마(Blockchain Trilemma)'** 라고도 부릅니다. 탈중앙화, 보안, 확장성 세 가지를 동시에 달성하기 어렵다는 의미입니다. 이더리움은 탈중앙화와 보안을 우선으로 확보했지만, 확장성 문제를 해결해야 하는 과제를 안게 되었습니다.

---

## 🧐 레이어2 확장성 솔루션의 등장

이더리움의 확장성 문제를 해결하기 위해 등장한 것이 바로 **레이어2(Layer 2)** 솔루션입니다. 레이어2는 이름 그대로 이더리움 메인넷(레이어1) 위에 구축된 **'두 번째 층'** 입니다.

핵심 아이디어는 **"모든 거래를 비싼 레이어1에서 처리하지 말고, 빠르고 저렴한 레이어2에서 대부분의 연산을 수행한 뒤, 그 최종 결과만 레이어1에 기록하자"** 는 것입니다.

이는 마치 꽉 막힌 본 도로 옆에 **새로운 고속도로**를 건설하는 것과 같습니다.

-   **레이어1 (이더리움 메인넷)**: 최종적인 보안과 합의를 책임지는 **'결제 및 정산 레이어'** 역할을 합니다. 모든 거래의 최종 결과가 이곳에 기록되어 안전하게 보관됩니다.
-   **레이어2 (확장성 솔루션)**: 실제 거래 실행과 연산을 담당하는 **'실행 레이어'** 역할을 합니다. 수수료가 저렴하고 처리 속도가 매우 빠릅니다.

---

## 롤업 (Rollups): 레이어2의 핵심 기술

레이어2 솔루션 중 현재 가장 주목받고 널리 사용되는 기술이 바로 **롤업(Rollup)** 입니다. 롤업은 단어 뜻 그대로, **수백, 수천 개의 트랜잭션을 '둘둘 말아서(Roll up)' 하나의 묶음으로 만든 뒤, 이더리움 레이어1에 제출**하는 방식입니다.

롤업은 크게 두 가지 종류로 나뉩니다.

### **1. 옵티미스틱 롤업 (Optimistic Rollups)**

-   **개념**: "일단 모든 거래가 올바르다고 **낙관적으로(Optimistic) 가정**하고, 문제가 있다면 나중에 이의를 제기하라"는 방식입니다.
-   **동작 방식**:
    1.  레이어2에서 수많은 거래를 실행하고, 그 결과와 거래 데이터를 레이어1에 제출합니다.
    2.  제출된 결과는 약 1주일의 **'이의 제기 기간(Fraud Proof Window)'** 을 갖습니다.
    3.  이 기간 동안 누구나 제출된 데이터에 오류나 사기 행위가 없는지 검증할 수 있습니다.
    4.  만약 사기 거래가 발견되면, 해당 사용자는 **'사기 증명(Fraud Proof)'** 을 레이어1에 제출하여 잘못된 결과를 바로잡고 보상을 받습니다. 사기를 시도한 측은 담보로 맡긴 자산을 몰수당하는 페널티를 받습니다.
    5.  아무런 이의 제기가 없으면, 해당 결과는 최종적으로 확정됩니다.
-   **장점**: 복잡한 계산 없이 결과를 제출하므로 구조가 비교적 간단하고, EVM 호환성이 높아 기존 이더리움 DApp을 쉽게 이전할 수 있습니다.
-   **단점**: 자금을 레이어1으로 다시 인출할 때, 이의 제기 기간(약 1주일)을 기다려야 하는 단점이 있습니다.
-   **대표 프로젝트**: **아비트럼(Arbitrum)**, **옵티미즘(Optimism)**

### **2. 영지식 롤업 (ZK-Rollups, Zero-Knowledge Rollups)**

-   **개념**: "모든 거래 묶음이 올바르게 처리되었음을 **영지식 증명(Zero-Knowledge Proof)** 이라는 암호학적 증거를 통해 증명"하는 방식입니다.
-   **동작 방식**:
    1.  레이어2에서 수많은 거래를 실행합니다.
    2.  실행 후, 해당 연산 과정 전체가 올바르다는 것을 증명하는 암호학적 **'유효성 증명(Validity Proof)'** 을 생성합니다. 이 증명은 거래의 세부 내용을 공개하지 않고도(Zero-Knowledge) 계산이 정확하다는 사실 자체를 증명할 수 있습니다.
    3.  이 '유효성 증명'과 압축된 거래 데이터를 레이어1에 제출합니다.
    4.  레이어1의 스마트 컨트랙트는 이 증명이 유효한지만 검증하면 됩니다. 증명 자체가 계산의 정확성을 보장하므로, 별도의 이의 제기 기간이 필요 없습니다.
-   **장점**: 증명이 검증되는 즉시 거래가 확정되므로, 자금을 레이어1으로 인출할 때 대기 시간이 거의 없습니다. 또한 거래 데이터를 더 효율적으로 압축할 수 있어 확장성이 더 높습니다.
-   **단점**: 영지식 증명을 생성하는 데 복잡하고 무거운 연산이 필요하며, EVM 호환성을 완벽하게 구현하기 위한 기술적 난이도가 높습니다.
-   **대표 프로젝트**: **zkSync**, **스타크넷(StarkNet)**, **폴리곤 zkEVM(Polygon zkEVM)**

### **한눈에 보는 롤업 비교**

| 구분 | **옵티미스틱 롤업 (Optimistic Rollup)** | **영지식 롤업 (ZK-Rollup)** |
| --- | --- | --- |
| **핵심 철학** | "문제 없겠지? 문제 있으면 신고해!" (결백 추정) | "내가 올바르다는 것을 수학적으로 증명할게." (유죄 추정) |
| **증명 방식** | **사기 증명 (Fraud Proof)** - 문제가 있을 때만 제출 | **유효성 증명 (Validity Proof)** - 항상 제출 |
| **L1 인출 시간** | 김 (약 1주일) | 짧음 (수 분 ~ 수 시간) |
| **기술적 복잡성** | 상대적으로 낮음 | 높음 |
| **EVM 호환성** | 높음 | 구현 중 (점점 발전하는 추세) |
| **대표 주자** | 아비트럼, 옵티미즘 | zkSync, 스타크넷 |

결론적으로, 롤업 기술은 이더리움의 보안을 그대로 유지하면서도 확장성을 크게 향상시켜, 사용자들이 더 빠르고 저렴하게 블록체인 서비스를 이용할 수 있도록 만드는 핵심적인 역할을 하고 있습니다.
