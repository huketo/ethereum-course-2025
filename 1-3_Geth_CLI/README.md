# 이더리움의 기초: Geth CLI를 이용한 계정 생성

태그: Blockchain, Geth, EOA, Keystore
프로젝트: 블록체인 강의

## 📜 들어가며: 왜 Geth를 사용할까?

이더리움 네트워크에 참여하고, 블록체인 데이터를 직접 다루기 위해서는 **이더리움 클라이언트**라는 소프트웨어가 필요합니다. 클라이언트는 이더리움 네트워크의 규칙을 실행하고, 다른 노드와 통신하며, 블록체인의 현재 상태를 유지하는 역할을 합니다.

**Geth(Go Ethereum)** 는 Go 언어로 개발된 가장 대표적이고 널리 사용되는 공식 이더리움 클라이언트입니다. Geth가 제공하는 CLI(Command-Line Interface) 도구를 사용하면, 우리는 이더리움의 가장 기본적인 구성 요소인 **계정(Account)** 을 직접 생성하고 그 내부 구조를 깊이 있게 이해할 수 있습니다.

이번 실습에서는 Geth를 통해 **외부 소유 계정(EOA, Externally Owned Account)** 을 직접 만들고, 이 과정에서 생성되는 **키스토어(Keystore) 파일**을 분석하여 **개인키, 공개키, 주소** 사이의 암호학적 관계를 명확히 파악하는 것을 목표로 합니다.

---

## 1. Geth 클라이언트 설치 및 기본 명령어 확인

> ⚠️ **사전 준비**: 실습을 진행하기 전에 각자의 운영체제에 맞는 Geth를 미리 설치해야 합니다. [Geth 공식 홈페이지](https://geth.ethereum.org/docs/install-and-build/installing-geth)를 참고하여 설치를 완료해주세요.

설치가 완료되었다면, 터미널(명령 프롬프트)을 열고 다음 명령어를 입력하여 Geth가 정상적으로 설치되었는지 확인합니다.

```bash
# Geth 버전 확인
geth version
```

버전 정보가 정상적으로 출력된다면 설치가 성공한 것입니다. 이제 Geth가 제공하는 다양한 하위 명령어들을 살펴보겠습니다.

```bash
# Geth 명령어 도움말 보기
geth --help
```

`account`, `attach`, `console`, `db`, `dump` 등 다양한 명령어 목록이 나타납니다. 우리는 이 중에서 계정 관리를 위한 `account` 명령어를 사용해 볼 것입니다.

---

## 2. `geth account new` 명령어로 EOA 생성하기

이제 Geth를 사용하여 새로운 이더리움 계정을 생성해 보겠습니다. 다음 명령어를 터미널에 입력하세요.

```bash
# 새로운 계정 생성
geth account new
```

명령어를 실행하면 먼저 계정을 암호화하는 데 사용할 비밀번호를 입력하라는 메시지가 나타납니다.

```
Your new account is locked with a password. Please give a password. Do not forget this password.
Password:
Repeat password:
```

> 🔐 **중요**: 여기서 입력하는 비밀번호는 매우 중요합니다. 이 비밀번호를 잊어버리면 해당 계정에 다시는 접근할 수 없게 되므로, 반드시 안전한 곳에 기록해 두어야 합니다.

비밀번호를 입력하고 나면, Geth는 새로운 계정을 생성하고 다음과 같은 정보를 출력합니다.

```
INFO [..] Your new key was generated       address=0x...
INFO [..] Please backup your key file      path=/home/user/.ethereum/keystore/UTC--2024-0...--0x...
...
Public address of the key:   0x...
Path of the secret key file: /home/user/.ethereum/keystore/UTC--2024-0...--0x...
```

여기서 주목해야 할 정보는 두 가지입니다.

-   **Public address of the key**: 이것이 바로 여러분의 새로운 이더리움 **계정 주소(Address)** 입니다. 다른 사람에게 이더(ETH)나 토큰을 받을 때 이 주소를 알려주면 됩니다. `0x`로 시작하는 42자리의 16진수 문자열입니다.
-   **Path of the secret key file**: 계정의 핵심 정보가 담긴 **키스토어(Keystore) 파일**이 저장된 경로입니다. 이 파일은 매우 중요하므로 안전하게 백업해야 합니다.

---

## 3. 키스토어(Keystore) 파일 분석하기

Geth가 생성한 키스토어 파일은 암호화된 개인키를 담고 있는 JSON 형식의 텍스트 파일입니다. 파일 이름은 보통 `UTC--`로 시작하며, 생성된 시간과 계정 주소를 포함하고 있습니다.

터미널에서 `cat`이나 `less` 명령어, 또는 텍스트 편집기를 사용하여 이 파일의 내용을 직접 확인해 봅시다.

```bash
# 키스토어 파일 내용 확인 (파일 경로는 위에서 출력된 실제 경로로 변경)
cat /home/user/.ethereum/keystore/UTC--2024-0...--0x...
```

파일을 열어보면 다음과 같은 JSON 구조를 볼 수 있습니다.

```json
{
  "address": "...",
  "crypto": {
    "cipher": "aes-128-ctr",
    "ciphertext": "...",
    "cipherparams": {
      "iv": "..."
    },
    "kdf": "scrypt",
    "kdfparams": {
      "dklen": 32,
      "n": 262144,
      "p": 1,
      "r": 8,
      "salt": "..."
    },
    "mac": "..."
  },
  "id": "...",
  "version": 3
}
```

-   **`address`**: 이 키스토어 파일에 해당하는 이더리움 주소입니다.
-   **`crypto.ciphertext`**: 가장 핵심적인 부분으로, 여러분의 **개인키(Private Key)를 `kdfparams`와 `cipherparams` 정보를 사용하여 암호화한 결과**입니다.
-   **`crypto.kdf`**: 'Key Derivation Function'의 약자로, 입력한 비밀번호를 암호화 키로 변환하는 데 사용된 알고리즘(여기서는 `scrypt`)을 의미합니다.
-   **`crypto.mac`**: 'Message Authentication Code'의 약자로, 이 파일이 변조되지 않았음을 검증하는 데 사용되는 값입니다.

**핵심은, 이 키스토어 파일 자체는 개인키가 아니라는 점입니다.** 이것은 **개인키를 비밀번호로 암호화하여 안전하게 보관하는 '금고'** 와 같습니다. 따라서 이 파일을 다른 사람에게 전송하더라도, 여러분이 설정한 비밀번호를 모르면 절대로 안의 개인키를 꺼낼 수 없습니다.

---

## 🔑 개인키, 공개키, 주소의 관계 정리

이번 실습을 통해 우리는 이더리움 계정의 핵심 구성 요소들이 어떻게 생성되고 연결되는지 알 수 있습니다.

1.  **개인키 (Private Key)**
    -   **생성**: Geth는 먼저 암호학적으로 안전한 난수 생성 알고리즘을 사용하여 256비트(64자리의 16진수) 길이의 **개인키**를 만듭니다. 이것이 모든 것의 시작이자, 계정의 소유권을 증명하는 유일한 열쇠입니다.
    -   **역할**: 트랜잭션에 서명하여 자산의 이동을 승인하는 데 사용됩니다. **개인키는 절대로 외부에 노출되어서는 안 됩니다.**

2.  **공개키 (Public Key)**
    -   **생성**: **타원곡선 암호(ECDSA)** 알고리즘을 사용하여 **개인키로부터 공개키를 계산**해냅니다. 이 과정은 단방향으로, 공개키에서 개인키를 역산하는 것은 불가능합니다.
    -   **역할**: 트랜잭션 서명이 해당 개인키의 소유자에 의해 이루어졌음을 검증하는 데 사용됩니다.

3.  **주소 (Address)**
    -   **생성**: **공개키에서 Keccak-256 해시 알고리즘을 통해 해시값을 계산**한 뒤, 이 값의 마지막 20바이트(40자리의 16진수)를 가져와 최종적으로 주소를 만듭니다.
    -   **역할**: 자금을 주고받는 데 사용되는 공개된 식별자입니다. 은행의 계좌번호와 같습니다.

**개인키 → 공개키 → 주소** 의 과정은 모두 단방향으로 이루어지기 때문에, 주소나 공개키가 노출되더라도 개인키는 안전하게 유지됩니다.

Geth는 이 모든 과정을 내부적으로 처리한 뒤, 가장 중요한 **개인키**를 여러분이 입력한 **비밀번호**로 암호화하여 **키스토어 파일**이라는 안전한 형태로 저장해 준 것입니다. 앞으로 MetaMask와 같은 지갑에 이 계정을 사용하고 싶다면, 이 키스토어 파일과 비밀번호를 이용하거나, 파일에서 추출한 개인키를 직접 '가져오기(Import)'하면 됩니다.
